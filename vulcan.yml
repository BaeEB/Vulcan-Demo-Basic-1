--- # Start
name: example

# 유저의 github 저장소 정보
url:
docker-image:

# predefined docker-image를 사용하되, 추가적인 설정이 필요한 경우 이렇게 정의
extra-build-env-setting-commands:

test-candidates: |
  Src/parse.c

time-out: 3600
max-patch-number : 500

test-build-command: |
  autoheader
  autoconf
  ./configure --with-tcsetpgrp
  sed -i '/^name=zsh\/zpty/ s/link=no/link=static/' config.modules
  make clean
  make -j10
  sed -i 's|sleep 1;||' Test/Makefile

# Command to build user's project with coverage measurement
coverage-build-command: |
  autoheader
  autoconf
  ./configure --with-tcsetpgrp --enable-cflags="--coverage -g -O0" --enable-libs="-lgcov"
  sed -i '/^name=zsh\/zpty/ s/link=no/link=static/' config.modules
  make clean
  make -j10
  sed -i 's|sleep 1;||' Test/Makefile


# 테스트 type이 문제: gtest의 경우 원하는 테스트를 실행할 수 있으니 문제가 없음
# 그렇지 않으면 test-case에 실행할 테스트 번호를 range로 하도록함
# 테스트 실행 역시 range안에 있는 테스트들만 실행하도록 묶어서 command를 부르거나 여러번 불러야함
test-type: automake
test-list: | # 테스트 리스트 커맨드 / 테스트를 하나씩 실행하기 위해 테스트 리스트를 출력해주는 내용 필요
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=13; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=14; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=15; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=16; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=17; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=18; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=19; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=20; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=21; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=22; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=23; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=24; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  [ -f AUTOMAKE_TEST_CASE.output ] || find Test -type f -name "*.ztst" -exec basename {} .ztst \; | sort -t '\0' > AUTOMAKE_TEST_CASE.output; sed -i '/X04zlehighlight/d' AUTOMAKE_TEST_CASE.output ; index=25; make -s TESTNUM=$(sed -n \"${index}p\" < AUTOMAKE_TEST_CASE.output) check
  

test-case:

test-command: | # 테스트 실행
  bash -c "@testcase@"
test-coverage-command: | # 커버리지 테스트 실행 / 테스트 대상을 입력받아서 하나씩 실행할 수 있어야 함
  bash -c "@testcase@"
gcov-exclusion-list: | # 커버리지 제외 대상
  test*.o
  
gcov-inclusion-list:
  parse.o
